# manifoldflasso_jmlr
This repository contains code for generation of figures in the Manifold Coordinates with Physical Meaning (Koelle, Zhang, Meila, Chen).
The major steps are 1) configuring the virtual environment and 2) running the code.

1) Configuring the virtual environment

This part can be done prior to cloning the manifoldflasso_jmlr repository, and does not depend on being run in the same directory.

1.1) Create a virtual env with megaman dependencies

conda create -n manifold_env_resubmission python=3.5 -y
source activate manifold_env_resubmission
conda install --channel=conda-forge -y pip nose coverage cython numpy scipy scikit-learn pyflann pyamg h5py plotly

1.2) Install megaman following instructions here (https://github.com/mmp2/megaman)

1.3) Configure jupiter notebook
conda install -c anaconda ipython
conda install -c anaconda ipykernel
ipython kernel install --user --name=manifold_env_resubmission --display-name=manifold_env_resubmission

2) Running the code

Be sure to activate the environment

source activate manifold_env_resubmission

2.a) Toy Data)

The RigidEthanol and SwissRoll examples simulate data, and so can be run without adding other files using 

python codes/experiments/re_0219_diagram.py
python codes/experiments/swissroll_041420_nsel_50_nreps5.py

or

sbatch python codes/experiments/re_0219_diagram.sh
sbatch python codes/experiments/swissroll_041420_nsel_50_nreps5.sh

Figures may be generated with 

codes/swiss_jmlrresubmission.ipynb
codes/rigidethanol_jmlrresubmission.ipynb

2.b MDS Data)

The Toluene, Ethanol, and Malonaldehyde examples require paths to data to be specified.
 Data is available at xxx.

2.b.1 Diagram dictionaries)

These will run much faster than full dictionaries, and are runnable on a 2015 macbook pro.

Results can be created e.g.

python codes/experiments/eth_0219_diagram.py
python codes/experiments/mal_0219_diagram.py
python codes/experiments/toluene_0219_diagram.py

or 

sbatch python codes/experiments/eth_0219_diagram.sh
sbatch codes/experiments/mal_0219_diagram.sh
sbatch codes/experiments/toluene_0219_diagram.sh

Figures can then be generated using
codes/aprioridictionaries_jmlrresubmission.ipynb
codes/rigidethanol_jmlrresubmission_final.ipynb
codes/toluene_jmlr_apriori_final.ipynb

2.b.2 Full dictionaries)

These are slower.  1 replicate takes around 1 hour on a 2015 macbook pro. 

python codes/experiments/eth_0219_full.py
python codes/experiments/mal_0219_full.py

or

sbatch codes/experiments/eth_0219_full.py.sh
sbatch codes/experiments/mal_0219_full.py.sh

Figures can then be generated using e.g.

codes/eth_fulldictionary_jmlrresubmission_mflasso_final.ipynb
codes/eth_fulldictionary_jmlrresubmission_plotmanifolds.ipynb
codes/eth_fulldictionary_jmlrresubmission_mflassobrute_final.ipynb
codes/mal_fulldictionary_jmlrresubmission_mflasso_final.ipynb
codes/mal_fulldictionary_jmlrresubmission_mflassobrute_final.ipynb
codes/mal_fulldictionary_jmlrresubmission_plotmanifolds.ipynb



